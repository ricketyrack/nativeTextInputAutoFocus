{"dependencies":[{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"./logging","data":{"isAsync":false}},{"name":"react-native","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _regeneratorRuntime = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/regenerator\");\n\n  var log = _$$_REQUIRE(_dependencyMap[1], \"./logging\");\n\n  var NativeCodePush = _$$_REQUIRE(_dependencyMap[2], \"react-native\").NativeModules.CodePush;\n\n  var RestartManager = function () {\n    var _allowed = true;\n    var _restartInProgress = false;\n    var _restartQueue = [];\n\n    function allow() {\n      log(\"Re-allowing restarts\");\n      _allowed = true;\n\n      if (_restartQueue.length) {\n        log(\"Executing pending restart\");\n        restartApp(_restartQueue.shift(1));\n      }\n    }\n\n    function clearPendingRestart() {\n      _restartQueue = [];\n    }\n\n    function disallow() {\n      log(\"Disallowing restarts\");\n      _allowed = false;\n    }\n\n    function restartApp() {\n      var onlyIfUpdateIsPending,\n          _args = arguments;\n      return _regeneratorRuntime.async(function restartApp$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              onlyIfUpdateIsPending = _args.length > 0 && _args[0] !== undefined ? _args[0] : false;\n\n              if (!_restartInProgress) {\n                _context.next = 6;\n                break;\n              }\n\n              log(\"Restart request queued until the current restart is completed\");\n\n              _restartQueue.push(onlyIfUpdateIsPending);\n\n              _context.next = 19;\n              break;\n\n            case 6:\n              if (_allowed) {\n                _context.next = 11;\n                break;\n              }\n\n              log(\"Restart request queued until restarts are re-allowed\");\n\n              _restartQueue.push(onlyIfUpdateIsPending);\n\n              _context.next = 19;\n              break;\n\n            case 11:\n              _restartInProgress = true;\n              _context.next = 14;\n              return _regeneratorRuntime.awrap(NativeCodePush.restartApp(onlyIfUpdateIsPending));\n\n            case 14:\n              if (!_context.sent) {\n                _context.next = 17;\n                break;\n              }\n\n              log(\"Restarting app\");\n              return _context.abrupt(\"return\");\n\n            case 17:\n              _restartInProgress = false;\n\n              if (_restartQueue.length) {\n                restartApp(_restartQueue.shift(1));\n              }\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      });\n    }\n\n    return {\n      allow: allow,\n      clearPendingRestart: clearPendingRestart,\n      disallow: disallow,\n      restartApp: restartApp\n    };\n  }();\n\n  module.exports = RestartManager;\n});","map":[[4,0,1,0],[4,6,1,6,"log"],[4,9,1,9],[4,12,1,12,"require"],[4,23,1,19],[4,55,1,0],[6,0,2,0],[6,6,2,6,"NativeCodePush"],[6,20,2,20],[6,23,2,23,"require"],[6,34,2,30],[6,69,2,23],[6,70,2,47,"NativeModules"],[6,83,2,23],[6,84,2,61,"CodePush"],[6,92,2,0],[8,0,4,0],[8,6,4,6,"RestartManager"],[8,20,4,20],[8,23,4,24],[8,35,4,30],[9,0,5,4],[9,8,5,8,"_allowed"],[9,16,5,16],[9,19,5,19],[9,23,5,4],[10,0,6,4],[10,8,6,8,"_restartInProgress"],[10,26,6,26],[10,29,6,29],[10,34,6,4],[11,0,7,4],[11,8,7,8,"_restartQueue"],[11,21,7,21],[11,24,7,24],[11,26,7,4],[13,0,9,4],[13,13,9,13,"allow"],[13,18,9,4],[13,21,9,21],[14,0,10,8,"log"],[14,6,10,8,"log"],[14,9,10,11],[14,10,10,12],[14,32,10,11],[14,33,10,8],[15,0,11,8,"_allowed"],[15,6,11,8,"_allowed"],[15,14,11,16],[15,17,11,19],[15,21,11,8],[17,0,13,8],[17,10,13,12,"_restartQueue"],[17,23,13,25],[17,24,13,26,"length"],[17,30,13,8],[17,32,13,34],[18,0,14,12,"log"],[18,8,14,12,"log"],[18,11,14,15],[18,12,14,16],[18,39,14,15],[18,40,14,12],[19,0,15,12,"restartApp"],[19,8,15,12,"restartApp"],[19,18,15,22],[19,19,15,23,"_restartQueue"],[19,32,15,36],[19,33,15,37,"shift"],[19,38,15,23],[19,39,15,43],[19,40,15,23],[19,41,15,22],[19,42,15,12],[20,0,16,9],[21,0,17,5],[23,0,19,4],[23,13,19,13,"clearPendingRestart"],[23,32,19,4],[23,35,19,35],[24,0,20,8,"_restartQueue"],[24,6,20,8,"_restartQueue"],[24,19,20,21],[24,22,20,24],[24,24,20,8],[25,0,21,5],[27,0,23,4],[27,13,23,13,"disallow"],[27,21,23,4],[27,24,23,24],[28,0,24,8,"log"],[28,6,24,8,"log"],[28,9,24,11],[28,10,24,12],[28,32,24,11],[28,33,24,8],[29,0,25,8,"_allowed"],[29,6,25,8,"_allowed"],[29,14,25,16],[29,17,25,19],[29,22,25,8],[30,0,26,5],[32,0,28,4],[32,13,28,19,"restartApp"],[32,23,28,4],[33,0,28,4],[34,0,28,4],[35,0,28,4],[36,0,28,4],[37,0,28,4],[38,0,28,4],[39,0,28,30,"onlyIfUpdateIsPending"],[39,14,28,30,"onlyIfUpdateIsPending"],[39,35,28,4],[39,94,28,54],[39,99,28,4],[41,0,28,4],[41,19,29,12,"_restartInProgress"],[41,37,28,4],[42,0,28,4],[43,0,28,4],[44,0,28,4],[46,0,30,12,"log"],[46,14,30,12,"log"],[46,17,30,15],[46,18,30,16],[46,81,30,15],[46,82,30,12],[48,0,31,12,"_restartQueue"],[48,14,31,12,"_restartQueue"],[48,27,31,25],[48,28,31,26,"push"],[48,32,31,12],[48,33,31,31,"onlyIfUpdateIsPending"],[48,54,31,12],[50,0,28,4],[51,0,28,4],[53,0,28,4],[54,0,28,4],[54,18,32,20,"_allowed"],[54,26,28,4],[55,0,28,4],[56,0,28,4],[57,0,28,4],[59,0,33,12,"log"],[59,14,33,12,"log"],[59,17,33,15],[59,18,33,16],[59,72,33,15],[59,73,33,12],[61,0,34,12,"_restartQueue"],[61,14,34,12,"_restartQueue"],[61,27,34,25],[61,28,34,26,"push"],[61,32,34,12],[61,33,34,31,"onlyIfUpdateIsPending"],[61,54,34,12],[63,0,28,4],[64,0,28,4],[66,0,28,4],[67,0,36,12,"_restartInProgress"],[67,14,36,12,"_restartInProgress"],[67,32,36,30],[67,35,36,33],[67,39,36,12],[68,0,28,4],[69,0,28,4],[69,47,37,22,"NativeCodePush"],[69,61,37,36],[69,62,37,37,"restartApp"],[69,72,37,22],[69,73,37,48,"onlyIfUpdateIsPending"],[69,94,37,22],[69,95,28,4],[71,0,28,4],[72,0,28,4],[73,0,28,4],[74,0,28,4],[75,0,28,4],[77,0,40,16,"log"],[77,14,40,16,"log"],[77,17,40,19],[77,18,40,20],[77,34,40,19],[77,35,40,16],[78,0,28,4],[80,0,28,4],[81,0,44,12,"_restartInProgress"],[81,14,44,12,"_restartInProgress"],[81,32,44,30],[81,35,44,33],[81,40,44,12],[83,0,45,12],[83,18,45,16,"_restartQueue"],[83,31,45,29],[83,32,45,30,"length"],[83,38,45,12],[83,40,45,38],[84,0,46,16,"restartApp"],[84,16,46,16,"restartApp"],[84,26,46,26],[84,27,46,27,"_restartQueue"],[84,40,46,40],[84,41,46,41,"shift"],[84,46,46,27],[84,47,46,47],[84,48,46,27],[84,49,46,26],[84,50,46,16],[85,0,47,13],[87,0,28,4],[88,0,28,4],[89,0,28,4],[90,0,28,4],[91,0,28,4],[92,0,28,4],[93,0,28,4],[95,0,51,4],[95,11,51,11],[96,0,52,8,"allow"],[96,6,52,8,"allow"],[96,11,52,13],[96,13,52,8,"allow"],[96,18,51,11],[97,0,53,8,"clearPendingRestart"],[97,6,53,8,"clearPendingRestart"],[97,25,53,27],[97,27,53,8,"clearPendingRestart"],[97,46,51,11],[98,0,54,8,"disallow"],[98,6,54,8,"disallow"],[98,14,54,16],[98,16,54,8,"disallow"],[98,24,51,11],[99,0,55,8,"restartApp"],[99,6,55,8,"restartApp"],[99,16,55,18],[99,18,55,8,"restartApp"],[100,0,51,11],[100,5,51,4],[101,0,57,1],[101,3,4,23],[101,5,4,0],[103,0,59,0,"module"],[103,2,59,0,"module"],[103,8,59,6],[103,9,59,7,"exports"],[103,16,59,0],[103,19,59,17,"RestartManager"],[103,33,59,0]]},"type":"js/module"}]}